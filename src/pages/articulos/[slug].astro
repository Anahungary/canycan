---
// src/pages/articulos/[slug].astro - CORREGIDO
import { getCollection } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const articulos = await getCollection('articulos');
  
  return articulos.map((articulo) => ({
    params: { slug: articulo.slug },
    props: { articulo }
  }));
}

const { articulo } = Astro.props;
const { Content, headings } = await articulo.render();

// Preparar datos para el layout con valores por defecto
const articleData = {
  title: articulo.data.title,
  description: articulo.data.description,
  author: {
    name: articulo.data.author || 'Editor PataDigital',
    avatar: '/images/authors/default.jpg',
    bio: articulo.data.authorBio || 'Especialista en cuidado y bienestar de mascotas'
  },
  date: articulo.data.date.toISOString(),
  readingTime: articulo.data.readingTime || 5,
  categories: articulo.data.tags || [],
  image: articulo.data.image || '/images/articles/default.jpg',
  views: 0,
  showTableOfContents: true,
  popularArticles: [
    {
      title: "Golden Retriever vs Labrador: ¿Cuál elegir?",
      slug: "golden-vs-labrador", 
      readingTime: 12,
      category: "Razas"
    },
    {
      title: "Guía completa de alimentación canina",
      slug: "alimentacion-canina",
      readingTime: 8,
      category: "Alimentación"
    },
    {
      title: "Entrenamiento básico para cachorros",
      slug: "entrenamiento-cachorros",
      readingTime: 6,
      category: "Entrenamiento"
    },
    {
      title: "Cuidados preventivos para tu mascota",
      slug: "salud-preventiva",
      readingTime: 10,
      category: "Salud"
    },
    {
      title: "Guía para gatos de interior",
      slug: "gatos-indoor",
      readingTime: 7,
      category: "Gatos"
    }
  ]
};
---

<ArticleLayout {...articleData}>
  <Content />
</ArticleLayout>