---
// ShareButtons.astro - Componente para botones de compartir en redes sociales
interface Props {
  url: string;
  title: string;
  vertical?: boolean;
  showLabel?: boolean;
}

const { 
  url, 
  title, 
  vertical = false,
  showLabel = true
} = Astro.props;

// Verificar si la URL es absoluta, si no, hacerla absoluta
const getAbsoluteUrl = (relativeUrl: string) => {
  if (relativeUrl.startsWith('http')) return relativeUrl;
  
  const baseUrl = import.meta.env.SITE || 'https://revista-mascotas.com';
  return `${baseUrl}${relativeUrl.startsWith('/') ? '' : '/'}${relativeUrl}`;
};

const absoluteUrl = getAbsoluteUrl(url);
const encodedUrl = encodeURIComponent(absoluteUrl);
const encodedTitle = encodeURIComponent(title);

// Definir los botones de redes sociales
const socialButtons = [
  {
    name: 'Facebook',
    url: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,
    icon: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd" />
          </svg>`,
    color: 'bg-[#1877F2] hover:bg-[#166FE5]'
  },
  {
    name: 'Twitter',
    url: `https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`,
    icon: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
          </svg>`,
    color: 'bg-[#1DA1F2] hover:bg-[#0C8BD9]'
  },
  {
    name: 'WhatsApp',
    url: `https://wa.me/?text=${encodedTitle}%20${encodedUrl}`,
    icon: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fill-rule="evenodd" d="M20.611 3.289C18.42 1.166 15.509 0 12.425 0 5.687 0 .146 5.478.143 12.215c-.001 2.152.558 4.253 1.62 6.109l-1.72 6.284 6.436-1.665c1.78.97 3.793 1.482 5.838 1.483h.006c6.736 0 12.278-5.478 12.28-12.217.002-3.26-1.268-6.326-3.572-8.634l.001.003zM12.423 22.282h-.004c-1.825 0-3.615-.488-5.183-1.409l-.372-.22-3.85.996 1.018-3.725-.242-.382c-1.015-1.631-1.55-3.513-1.55-5.44.002-5.653 4.615-10.254 10.293-10.254 2.75.001 5.333 1.074 7.275 3.019 1.939 1.941 3.007 4.521 3.006 7.267-.001 5.566-4.614 10.149-10.384 10.149l-.007-.001z" clip-rule="evenodd" />
            <path fill-rule="evenodd" d="M18.452 14.787c-.312-.157-1.846-.9-2.134-.998-.286-.099-.494-.148-.703.149-.208.297-.809.997-.99 1.197-.184.2-.367.225-.677.075-.312-.15-1.318-.478-2.507-1.521-.925-.813-1.55-1.817-1.732-2.125-.183-.306-.019-.473.137-.626.141-.137.314-.356.472-.535.157-.178.21-.306.314-.51.104-.206.053-.387-.026-.54-.08-.152-.704-1.66-1.057-2.339-.262-.579-.537-.501-.704-.51-.183-.01-.392-.012-.6-.012-.21 0-.548.079-.835.377-.285.298-1.09 1.049-1.09 2.559 0 1.508 1.117 2.973 1.274 3.179.159.206 2.202 3.509 5.447 4.773.76.323 1.354.517 1.818.664.764.238 1.46.204 2.008.124.613-.09 1.846-.739 2.107-1.454.26-.714.26-1.326.183-1.454-.08-.127-.285-.202-.595-.352z" clip-rule="evenodd" />
          </svg>`,
    color: 'bg-[#25D366] hover:bg-[#20BD5C]'
  },
  {
    name: 'Pinterest',
    url: `https://pinterest.com/pin/create/button/?url=${encodedUrl}&description=${encodedTitle}`,
    icon: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z" />
          </svg>`,
    color: 'bg-[#E60023] hover:bg-[#D50C22]'
  },
  {
    name: 'Email',
    url: `mailto:?subject=${encodedTitle}&body=${encodedUrl}`,
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>`,
    color: 'bg-gray-600 hover:bg-gray-700'
  }
];
---

<div class={`share-buttons ${vertical ? 'flex flex-col space-y-2' : 'flex flex-wrap gap-2'}`}>
  {socialButtons.map(button => (
    <a 
      href={button.url} 
      target="_blank" 
      rel="noopener noreferrer"
      class={`${button.color} text-white rounded-md transition-colors duration-200 inline-flex items-center justify-center ${vertical ? 'p-2' : showLabel ? 'px-4 py-2' : 'p-2'}`}
      aria-label={`Compartir en ${button.name}`}
    >
      <span class="inline-block" set:html={button.icon} />
      {showLabel && (
        <span class={`${vertical ? 'sr-only' : 'ml-2'}`}>{button.name}</span>
      )}
    </a>
  ))}
</div>