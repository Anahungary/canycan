---
// CategoryLayout.astro - Layout para p√°ginas de categor√≠a CON ICONO DE NEWSLETTER
import BaseLayout from './BaseLayout.astro';
import Container from '../components/ui/Container.astro';
import ArticleList from '../components/blog/ArticleList.astro';
import Card from '../components/ui/Card.astro';
import Badge from '../components/ui/Badge.astro';
import Newsletter from '../components/common/Newsletter.astro';  // ‚Üê AGREGAR ESTA L√çNEA

import { Image } from 'astro:assets';

interface Props {
  title: string;
  description: string;
  image?: string;
  category: string;
  subcategories?: string[];
  articles: any[];
  popularTags?: string[];
  featuredArticle?: any;
}

const { 
  title, 
  description, 
  image = '/images/categories/default.jpg',
  category,
  subcategories = [],
  articles = [],
  popularTags = [],
  featuredArticle
} = Astro.props;
---

<BaseLayout
  title={title}
  description={description}
  ogImage={image}
>
  {/* Hero con gradiente verde mejorado */}
  <div class="relative bg-gradient-to-br from-green-500 via-green-600 to-emerald-600 text-white overflow-hidden">
    {/* Patr√≥n de fondo decorativo */}
    <div class="absolute inset-0 opacity-10">
      <div class="absolute -top-4 -right-4 w-32 h-32 bg-white rounded-full blur-xl"></div>
      <div class="absolute top-1/2 -left-8 w-24 h-24 bg-yellow-300 rounded-full blur-lg"></div>
      <div class="absolute -bottom-6 right-1/3 w-40 h-40 bg-white rounded-full blur-2xl"></div>
    </div>
    
    <!-- Ondas decorativas -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1200 120" class="w-full h-12 fill-current text-white">
        <path d="M0,60 C300,120 900,0 1200,60 L1200,120 L0,120 Z" />
      </svg>
    </div>
    
    <Container>
      <div class="py-20 md:py-28 relative z-10">
        <div class="max-w-4xl mx-auto text-center">
          {/* Badge de categor√≠a */}
          <div class="inline-block mb-6">
            <span class="bg-white/20 backdrop-blur-sm text-white px-6 py-3 rounded-full text-sm font-bold uppercase tracking-wider border border-white/30">
              üìö Categor√≠a
            </span>
          </div>
          
          <h1 class="text-4xl md:text-6xl font-bold mb-6 text-white leading-tight">
            {title}
          </h1>
          <p class="text-xl md:text-2xl opacity-95 mb-10 leading-relaxed max-w-3xl mx-auto">
            {description}
          </p>
          
          {/* Estad√≠sticas */}
          <div class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-2xl mx-auto mb-8">
            <div class="bg-white/15 backdrop-blur-sm rounded-xl p-4 border border-white/20">
              <div class="text-3xl font-bold text-yellow-300">{articles.length}</div>
              <div class="text-sm opacity-90">Art√≠culos</div>
            </div>
            <div class="bg-white/15 backdrop-blur-sm rounded-xl p-4 border border-white/20">
              <div class="text-3xl font-bold text-yellow-300">{subcategories.length}</div>
              <div class="text-sm opacity-90">Temas</div>
            </div>
            <div class="bg-white/15 backdrop-blur-sm rounded-xl p-4 border border-white/20 md:block hidden">
              <div class="text-3xl font-bold text-yellow-300">5‚òÖ</div>
              <div class="text-sm opacity-90">Calidad</div>
            </div>
          </div>
          
          {subcategories.length > 0 && (
            <div class="flex flex-wrap justify-center gap-3 mt-8">
              {subcategories.map(subcategory => (
                <a 
                  href={`/${category}/${subcategory.toLowerCase().replace(/\s+/g, '-')}`}
                  class="group bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white px-6 py-3 rounded-full text-sm font-medium transition-all duration-300 border border-white/20 hover:border-white/40 hover:scale-105"
                >
                  <span class="group-hover:mr-2 transition-all duration-200">{subcategory}</span>
                  <span class="opacity-0 group-hover:opacity-100 transition-opacity duration-200">‚Üí</span>
                </a>
              ))}
            </div>
          )}
        </div>
      </div>
    </Container>
  </div>
  
  <Container class="py-16">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
      {/* Contenido principal */}
      <div class="lg:col-span-8">
        {/* Art√≠culo destacado mejorado */}
        {featuredArticle && (
          <div class="mb-16">
            <div class="flex items-center gap-3 mb-8">
              <div class="w-20  rounded-xl flex items-center justify-center ">
                <img src="/images/perro3.svg" alt="Destacado" class="w-20" />
              </div>
              <h2 class="text-3xl font-bold text-gray-900">Art√≠culo destacado</h2>
            </div>
            
            <div class="group transition-all duration-500 hover:scale-[1.02]">
              <div class="bg-white rounded-2xl border border-gray-200 shadow-xl hover:shadow-2xl overflow-hidden transition-all duration-500 relative">
                <!-- Badge de destacado -->
                <div class="absolute top-6 left-6 z-10">
                  <span class="bg-gradient-to-r from-yellow-400 to-yellow-500 text-red-950 px-4 py-2 rounded-full text-xs font-bold shadow-lg">
                     DESTACADO
                  </span>
                </div>
                
                <div class="relative h-96 md:h-[500px]">
                  <Image 
                    src={featuredArticle.image} 
                    alt={featuredArticle.title}
                    width={1200}
                    height={600}
                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                  />
                  <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
                  
                  <div class="absolute bottom-0 left-0 right-0 p-8">
                    {/* Tags verdes como pediste */}
                    <div class="flex flex-wrap gap-2 mb-4">
                      {featuredArticle.categories?.map((cat: string) => (
                        <span class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg">
                          {cat}
                        </span>
                      ))}
                      {featuredArticle.categories?.length > 4 && (
                        <span class="bg-yellow-400 text-black px-3 py-1 rounded-full text-xs font-bold shadow-lg">
                          +{featuredArticle.categories.length - 4}
                        </span>
                      )}
                    </div>
                    
                    <h3 class="text-3xl md:text-4xl font-bold mb-4 text-white leading-tight">
                      {featuredArticle.title}
                    </h3>
                    <p class="text-lg text-gray-200 mb-6 leading-relaxed">
                      {featuredArticle.excerpt}
                    </p>
                    
                    <div class="flex items-center justify-between">
                      <a 
                        href={`/articulos/${featuredArticle.id}`}
                        class="inline-flex items-center bg-white text-gray-900 hover:bg-gray-100 px-8 py-4 rounded-xl text-sm font-bold transition-all duration-300 shadow-lg hover:shadow-xl group"
                      >
                        <span class="mr-2">Leer art√≠culo</span>
                        <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                      </a>
                      
                      <div class="text-white text-sm opacity-75">
                        ‚è±Ô∏è {featuredArticle.readingTime || 5} min lectura
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}
        
        {/* Lista de art√≠culos con header mejorado */}
        <div>
          <div class="flex items-center gap-3 mb-8">
            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg">
              <span class="text-2xl text-white">üìö</span>
            </div>
            <h2 class="text-3xl font-bold text-gray-900">Art√≠culos recientes</h2>
            <div class="flex-1 h-px bg-gradient-to-r from-green-200 to-transparent"></div>
          </div>
          
          <ArticleList 
            articles={articles} 
            layout="grid" 
            columns={2}
          />
        </div>
      </div>
      
      {/* Sidebar mejorado */}
      <div class="lg:col-span-4">
        <div class="sticky top-[140px] space-y-8">
          {/* Subcategor√≠as con dise√±o mejorado */}
          {subcategories.length > 0 && (
            <div class="bg-white rounded-2xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 p-8">
              <div class="flex items-center gap-3 mb-6">
                <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center">
                  <span class="text-white text-sm">üîç</span>
                </div>
                <h3 class="text-xl font-bold text-gray-900">Explorar {title}</h3>
              </div>
              
              <div class="space-y-2">
                {subcategories.map(subcategory => (
                  <a 
                    href={`/${category}/${subcategory.toLowerCase().replace(/\s+/g, '-')}`}
                    class="group flex items-center py-4 px-5 rounded-xl hover:bg-green-50 transition-all duration-300 border border-transparent hover:border-green-200"
                  >
                    <div class="w-3 h-3 bg-green-300 rounded-full mr-4 group-hover:bg-green-500 transition-colors duration-300"></div>
                    <span class="flex-1 font-medium text-gray-700 group-hover:text-green-700">{subcategory}</span>
                    <svg class="w-5 h-5 text-gray-400 opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </a>
                ))}
              </div>
            </div>
          )}
          
          {/* Etiquetas populares con colores que pediste */}
                    {popularTags.length > 0 && (
  <div class="bg-white rounded-2xl border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300 p-8">
    <div class="flex items-center gap-3 mb-6">
      <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center">
        <span class="text-white text-sm">üè∑Ô∏è</span>
      </div>
      <h3 class="text-xl font-bold text-gray-900">Temas populares</h3>
    </div>
    
    <div class="flex flex-wrap gap-3">
      {popularTags.map((tag, index) => (
        <a 
          href={`/tag/${tag.toLowerCase().replace(/\s+/g, '-')}`}
          class={`px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 hover:scale-105 ${
            index === 0 
              ? 'bg-green-100 hover:bg-green-200 text-green-800'
              : index === 1 
              ? 'bg-blue-100 hover:bg-blue-200 text-blue-800' 
              : index === 2
              ? 'bg-purple-100 hover:bg-purple-200 text-purple-800'
              : index === 3
              ? 'bg-orange-100 hover:bg-orange-200 text-orange-800'
              : index === 4
              ? 'bg-red-100 hover:bg-red-200 text-red-800'
              : 'bg-gray-100 hover:bg-gray-200 text-gray-800'
          }`}
        >
          {tag}
        </a>
      ))}
    </div>
  </div>
)}

          
          {/* Newsletter con icono SVG en lugar de emoji */}
          <Newsletter />

        </div>
      </div>
    </div>
    
    {/* Paginaci√≥n premium */}
    {articles.length >= 10 && (
      <div class="mt-20 flex justify-center">
        <nav class="flex items-center bg-white rounded-2xl shadow-xl border border-gray-200 p-3 gap-2">
          <a 
            href="#" 
            class="flex items-center px-6 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-xl text-sm font-medium transition-all duration-300 group"
          >
            <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Anterior
          </a>
          
          <div class="flex gap-1">
            <span class="px-4 py-3 bg-green-500 text-white rounded-xl text-sm font-bold shadow-md">1</span>
            <a href="#" class="px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-xl text-sm font-medium transition-all duration-300">2</a>
            <a href="#" class="px-4 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-xl text-sm font-medium transition-all duration-300">3</a>
            <span class="px-3 py-3 text-gray-400">...</span>
          </div>
          
          <a 
            href="#" 
            class="flex items-center px-6 py-3 text-gray-600 hover:bg-green-50 hover:text-green-600 rounded-xl text-sm font-medium transition-all duration-300 group"
          >
            Siguiente
            <svg class="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </a>
        </nav>
      </div>
    )}
  </Container>
</BaseLayout>

<style>
  /* Scroll suave y animaciones */
  html {
    scroll-behavior: smooth;
  }

  /* Efectos de glassmorphism */
  .backdrop-blur-sm {
    backdrop-filter: blur(4px);
  }

  /* Animaciones de hover mejoradas */
  .group:hover .group-hover\:scale-105 {
    transform: scale(1.05);
  }

  /* Gradientes animados */
  @keyframes gradient-shift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  .bg-gradient-to-br {
    background-size: 200% 200%;
    animation: gradient-shift 8s ease infinite;
  }
</style>